[mypy]
# Ignore missing stubs for third-party packages used only in runtime/tests
ignore_missing_imports = True
# Allow implicit Optional in this legacy codebase
no_implicit_optional = False
# Follow imports for local package sources
follow_imports = normal
# Be permissive about submodules
allow_redefinition = True
# Exclude duplicate/conflicting test files which break mypy runs
exclude = (?x)
	(^conftest\.py$)|                 # root-level conftest
	(^tests/)|(^CLEAN_APP/tests/)|(^app/tests/)|     # test folders to skip
	(^scripts/)|(^tools/)|(^tmp_)      # utility and temp folders

# Scope: focus type checking on core application package to keep signal high
files = app

# Relax strictness for now: many tests and legacy modules are untyped. We will
# run a stricter mypy pass incrementally on targeted modules later. This keeps
# CI actionable and avoids overwhelming noise while we apply targeted fixes.
warn_unused_ignores = True
warn_redundant_casts = True

[mypy-argon2.*]
ignore_missing_imports = True

[mypy-sendgrid.*]
ignore_missing_imports = True

[mypy-cryptography.*]
ignore_missing_imports = True

[mypy-asyncpg.*]
ignore_missing_imports = True

[mypy-aiohttp.*]
ignore_missing_imports = True

# Stricter checks for high-value modules - enable untyped-def checks incrementally
[mypy-app.auth]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.store]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.settings]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.admin]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.authz]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.routers.neon_proxy]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.metrics]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.logging_config]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.deps]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.security_session]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.__init__]
check_untyped_defs = True
disallow_untyped_defs = True

[mypy-app.subscriptions]
check_untyped_defs = True
disallow_untyped_defs = True

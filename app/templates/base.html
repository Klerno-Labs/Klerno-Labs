<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1"
  />
  <title>{{ title or "Klerno Labs" }}</title>

  <!-- Tailwind via CDN (no build step) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js for sparkline/line charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg: #0b1020;
      --panel: #121a34;
      --line: #1e2a52;
      --ink: #e8ecf3;
      --muted: #9aa9c6;
      --brand: #6c63ff;
      --danger: #ff5577;
      --ok: #10b981;
      --warn: #f59e0b;
    }
    body { background: var(--bg); color: var(--ink); }
    .card { background: var(--panel); border: 1px solid var(--line); border-radius: 16px; }
    .chip { border: 1px solid var(--line); background: rgba(255,255,255,0.03); }
    .pill { background: rgba(255,255,255,0.06); }
  </style>
</head>
<body class="min-h-screen">
  <header class="border-b border-[var(--line)]">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="{{ url_path_for('ui_dashboard') }}" class="text-xl font-semibold hover:opacity-90">Klerno Labs</a>
      <nav class="flex items-center gap-2">
        <a id="nav-dashboard" class="px-3 py-1.5 rounded-md chip hover:opacity-90" href="{{ url_path_for('ui_dashboard') }}">Dashboard</a>
        <a id="nav-alerts" class="px-3 py-1.5 rounded-md chip hover:opacity-90" href="{{ url_path_for('ui_alerts') }}">Alerts</a>
        <a class="px-3 py-1.5 rounded-md chip hover:opacity-90" href="/docs" target="_blank" rel="noopener">API Docs</a>
      </nav>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-6">
    {% block content %}{% endblock %}
  </main>

  <footer class="max-w-7xl mx-auto px-4 pb-8 text-sm text-[var(--muted)]">
    <div class="flex items-center justify-between">
      <span>© {{ (now().year if now else 2025) }} Klerno Labs — Klerno Labs</span>
      <span class="opacity-80">XRPL-first • Risk & Alerts</span>
    </div>
  </footer>

  <script>
    // Carry ?key=... through internal links so UI pages remain authorized
    (function attachKeyToLinks() {
      try {
        const params = new URLSearchParams(window.location.search);
        const key = params.get("key");
        if (!key) return;

        for (const a of document.querySelectorAll('a[href^="/"]')) {
          const url = new URL(a.getAttribute("href"), window.location.origin);
          url.searchParams.set("key", key);
          a.setAttribute("href", url.toString());
        }
      } catch {}
    })();
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>
